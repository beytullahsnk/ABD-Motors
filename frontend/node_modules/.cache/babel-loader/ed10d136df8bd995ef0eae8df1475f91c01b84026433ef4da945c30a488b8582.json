{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://localhost:8000/api/auth';\nconst authService = {\n  login: async (email, password) => {\n    try {\n      const response = await axios.post(`${API_URL}/token/`, {\n        email,\n        password\n      });\n      if (response.data.access) {\n        localStorage.setItem('user', JSON.stringify(response.data));\n      }\n      return response.data;\n    } catch (error) {\n      var _error$response;\n      console.error('Login error:', ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || error.message);\n      throw error;\n    }\n  },\n  register: async userData => {\n    try {\n      // Transformer les données pour correspondre au modèle backend\n      const backendData = {\n        username: userData.email,\n        email: userData.email,\n        password: userData.password,\n        first_name: userData.firstName,\n        last_name: userData.lastName,\n        phone: userData.phone,\n        role: 'CLIENT',\n        is_active: true\n      };\n      const response = await axios.post(`${API_URL}/users/`, backendData);\n      return response.data;\n    } catch (error) {\n      var _error$response2, _error$response3;\n      console.error('Register error:', ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || error.message);\n      if ((_error$response3 = error.response) !== null && _error$response3 !== void 0 && _error$response3.data) {\n        const errors = error.response.data;\n        if (typeof errors === 'object') {\n          // Construire un message d'erreur à partir des erreurs du backend\n          const errorMessage = Object.entries(errors).map(([field, messages]) => {\n            // Traduire les noms de champs pour l'utilisateur\n            const fieldTranslations = {\n              username: 'Nom d\\'utilisateur',\n              email: 'Email',\n              password: 'Mot de passe',\n              first_name: 'Prénom',\n              last_name: 'Nom',\n              phone: 'Téléphone'\n            };\n            const fieldName = fieldTranslations[field] || field;\n            return `${fieldName}: ${Array.isArray(messages) ? messages.join(', ') : messages}`;\n          }).join('\\n');\n          throw new Error(errorMessage);\n        }\n      }\n      throw error;\n    }\n  },\n  logout: () => {\n    localStorage.removeItem('user');\n  },\n  getCurrentUser: () => {\n    const user = localStorage.getItem('user');\n    return user ? JSON.parse(user) : null;\n  }\n};\nexport default authService;","map":{"version":3,"names":["axios","API_URL","authService","login","email","password","response","post","data","access","localStorage","setItem","JSON","stringify","error","_error$response","console","message","register","userData","backendData","username","first_name","firstName","last_name","lastName","phone","role","is_active","_error$response2","_error$response3","errors","errorMessage","Object","entries","map","field","messages","fieldTranslations","fieldName","Array","isArray","join","Error","logout","removeItem","getCurrentUser","user","getItem","parse"],"sources":["/Users/beytullahsonkaya/Library/Mobile Documents/com~apple~CloudDocs/Documents/BTS/Hetic/Cours Python/Projet - ABD motors/ABD-Motors/frontend/src/services/authService.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = 'http://localhost:8000/api/auth';\n\nconst authService = {\n    login: async (email, password) => {\n        try {\n            const response = await axios.post(`${API_URL}/token/`, {\n                email,\n                password\n            });\n            if (response.data.access) {\n                localStorage.setItem('user', JSON.stringify(response.data));\n            }\n            return response.data;\n        } catch (error) {\n            console.error('Login error:', error.response?.data || error.message);\n            throw error;\n        }\n    },\n\n    register: async (userData) => {\n        try {\n            // Transformer les données pour correspondre au modèle backend\n            const backendData = {\n                username: userData.email,\n                email: userData.email,\n                password: userData.password,\n                first_name: userData.firstName,\n                last_name: userData.lastName,\n                phone: userData.phone,\n                role: 'CLIENT',\n                is_active: true\n            };\n\n            const response = await axios.post(`${API_URL}/users/`, backendData);\n            return response.data;\n        } catch (error) {\n            console.error('Register error:', error.response?.data || error.message);\n            if (error.response?.data) {\n                const errors = error.response.data;\n                if (typeof errors === 'object') {\n                    // Construire un message d'erreur à partir des erreurs du backend\n                    const errorMessage = Object.entries(errors)\n                        .map(([field, messages]) => {\n                            // Traduire les noms de champs pour l'utilisateur\n                            const fieldTranslations = {\n                                username: 'Nom d\\'utilisateur',\n                                email: 'Email',\n                                password: 'Mot de passe',\n                                first_name: 'Prénom',\n                                last_name: 'Nom',\n                                phone: 'Téléphone'\n                            };\n                            const fieldName = fieldTranslations[field] || field;\n                            return `${fieldName}: ${Array.isArray(messages) ? messages.join(', ') : messages}`;\n                        })\n                        .join('\\n');\n                    throw new Error(errorMessage);\n                }\n            }\n            throw error;\n        }\n    },\n\n    logout: () => {\n        localStorage.removeItem('user');\n    },\n\n    getCurrentUser: () => {\n        const user = localStorage.getItem('user');\n        return user ? JSON.parse(user) : null;\n    },\n};\n\nexport default authService; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}